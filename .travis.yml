language: java
jdk:
- openjdk8
sudo: false
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
install: skip
test: skip
jobs:
  include:
  - stage: build pull request
    script: "./gradlew check jacocoTestReport"
    if: type = pull_request
  - stage: build master
    script: "./gradlew check jacocoTestReport publishMavenPublicationToSonatypeRepository"
    if: branch = master AND NOT type = pull_request
  - stage: build release
    if: branch =~ /release/
    script: "./gradlew check publishMavenPublicationToSonatypeRepository -Pversion=${TRAVIS_BRANCH#'release/'}"
  - stage: release
    if: branch =~ /release/
    script: "./gradlew closeAndReleaseRepository"
  - stage: github release
    if: branch =~ /release/
    script: "./scripts/github-release.sh"
after_success:
- bash <(curl -s https://codecov.io/bash)
before_install:
- |
  if [[ "$TRAVIS_PULL_REQUEST" = "false" ]]; then
    openssl aes-256-cbc -K $encrypted_7f20b2c8d0fe_key -iv $encrypted_7f20b2c8d0fe_iv -in web3j.asc.enc -out web3j.asc -d
  fi
env:
  global:
  - secure: QqsdH63hX4+6zVeWcu6Us0e5rg7zxjN7ESBjj0561/QlaouFK9/W6xlZED990kNHxJVFW4CprLpYXAoGZflKNweNDbSAP3q7wOGm+4YI+yjEPIijUB2s9RcVKVpx299ft1l69QJjRHPG+bnUEpj7AHDaaxQ3ewvYcKZZ7IH4BFP+MzHHvWrUhSUQaD0vJ/M2kywLBoPAYalIOqbZ09ITezuhZp47ExB0YS3ChITfnu0W46RhBq2Tdcwv0ebDZjraX47wt2a9iyeYK62bvXrV4Y6AYVFn0F0ecwrNFo6WTBU3TT9+uHFE9MH/LItDFjRBfjxD3ZxsjJX96BsHxQSmhRNE713BXeCFzauJYeVOJHcM/trfluH6PCAmUtjrJnu1qPzi+YpqSRX5mb5eZ9Ca2Lb5/ZFumDH9FjOuszI3Ck37KkxXKrZrw6iMelA+7Ma684vU4gnX95xFIDCn9IPnKPilUj7NdlBDMsEXhkeCgA+22ODw7RceL33E9wScni14YAtIL2aAOetcXlygexLD6vE6cU3jKs0hrG/FKeb8EpYYXje8kqA12ahpOjC/yemlA/RtrTKIY9a8IWTIU/5eyIxWh0QE4TBMTnDcx5dUCO79uhXKQdwemUTadYuGveWnFRm/u39QxvdqRhH9ILP6Vt9y7+Nq+9e3VoQOHaDzkcY=
  - secure: nIbN2xVVEMvpJZxxQI9A3+2LqZ2AUnEpm7KGv+BLaxsyGIcy2qnh47yWVoLkcmXURUtrWrveDyGPCNWJfW8l3QfoaWmm3pRbsHhagEJ9qomx6G/9OwmOEdT+QLCKJgDbYfBWH2bYtyUikQkmhElOjqfhwOHpQW1UAX2/FhVwqrwzku+mfzbkfE9zRmmcLDaSuKJ7hCXtAbh1a8gBd8uDeVPojzkxbJ2/52Uol6vH6bC1fJgzaxY31Rf1wwcVAwLOveHuyeCGmh+R/cth2CWpYXjFHj8Hx8XwWAuns/65swh+NjBH5HC3Y4fCGYqKIVPCjfU++1vwpIdHcekVDmjJLFlGVkrIOz/W+8yQG8DZTroacwNh996w40qnZUsgBRKu4fMe7DPOc2WSuIdz2qW8DfWzRYKGRXCM4qA+Mxxc0zk2R7d3QYnrSs8UsSz+kU9hZ6JZCNm4wBsBnNHdC6/VvrTl/xAlzw3t8AWmOAWT3rogp6XxVSRMizt8EYQt6ifxsB36mRBft6DMiiymMmHLFg7dG35P6Bo9fhGhnXknQ9eonDXo6/TQ0NZ512i+ize0Lh57gUvfmNAC8RJ3iOyDinV72CULfJeVEVLue1es/NVRo11UBlgBC6xSEhiRYRH8xVLb/P7NHD1fvC8RQnQ2avzopsXfw3DrAGF3GbmUWH4=
  - secure: Z9xTSswlbq8DuQ4l7ibQ3Crum3eocx33qodnayKhlmzcCnClyQ+vTAZoB/+EJr4JaIpTkJjVdjgDmAAvXVOrOeozIGqfureYa2fugH0fIKYWMl+bps3TEylPl/XRWu2pSx4AHzYNc1wYHIZ0VobQsTB4cxMf15HCuA1tZ80fqEgzDr3qJ5A9KjtiOl6zn/jbB48xc4/4cbIVANWMir1Gu1R8WEBwtQlEGZhgX66tiz5V6EaKgqL9jg31ljENYb2C5h0Vncww1JXOXICqgDQAj4CB9qq8V1W1D5g7VncG0+2nfOk4mhwRr0QjKUauFAC9F/iD9kQOinLezSYaaLn96ZQRDGVT5qxJ+sdotr0a+6cCML+ai579xdzfsJaJilZoDshsYaennxyDimEQxn6qqbF5viY28ifnoTAE6lj9m9LfgSXaYnwVbmWfeP9TtjOVTeDGBLreXbo9zTxUvsFWo5u1XGxymtWgbLxFi1qDSX+w9VjNoJDHYYFSS88gucN1hxoJrW+xGkDy8A0XLiw8QMEayivXsD/dw+PnPRgozNoKlhF7KQXO5n7IUyRFcFk0D0Uo9g/1m/zNm3O1nEajsLNIGzv0Yw8iDXQl9nRTnGmLMKhBKSKYwHAVUdMgGyEVM1d7Fj4TEF1uhm3iuulzuLaaTi29hzfYmWtmgtYg+qY=
  - secure: sigzcUH4s8g8JFg22YE4q1mpsP0X66q3Z8q/e3HtR1sN1o8pm/hjQ1vHxovueBggMJRXY0KH3RbF5LNOwCzyYuXqpjnYrL8GYDN1LQP2tNjpsQOY3ylwsM0qWgnp+U7vKT4rQsQS1ibH5AVK7PpRwzjtJuYmoVrEKzKGlTKFYU6rbFpHrchfObe1jSG4TjxOsMM8EgbZYjq7Ebl43C6S+Squtu7UdPPJ4rkChQ2HQOtc8BlM2UuGElaeeOwAViB/s7XGqkcj5oPWRPVjyvK2bDXiZR+6BIpIzByGlVH+mIKe+HJg0jYfAXwkDIHtHQZqZWxQr1z135sHtXLQsC/Z7+0MBGNGC4UoyUVPCGvGlwib/NLncMqlnhoJqom5ZikI2tPzLFOKwCV7Fc+sngqBF3jmjRyKim37In/VRauKBTczMoODu3y8558+hVpxe0CYdmT2raQGxRMNGO+QmoMs1dVc3N0ZB751v//CqGlEqNyD/2wyXOQOJAt0ejAuZSZ4NjB4/rARpbDUIvCyMkC+zvYbxfBbp+ZM8YDN/UUvCkxK9uL6F+mRkOX1NcgwhHln7O2FuljThRHu+MBcNM0voxLS1fSlkZRQ36UX6yLFwYgdLQkCpEXWHuU6m6Zto8sBtJEUkpvH+RkfLXqwxN+cf9906tMZnnZfWF0fxc4jr84=
