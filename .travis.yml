language: java
jdk:
- openjdk8
sudo: false
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
install: skip
test: skip
jobs:
  include:
  - stage: build pull request
    script: "./gradlew check jacocoTestReport"
    if: type = pull_request
  - stage: build master
    script: "./gradlew check jacocoTestReport publish"
    if: branch = master AND NOT type = pull_request
  - stage: build release
    if: branch =~ /release/
    script: "./gradlew check publish -Pversion=${TRAVIS_BRANCH#'release/'}"
  - stage: release
    if: branch =~ /release/
    script: "./gradlew closeAndReleaseRepository"
  - stage: github release
    if: branch =~ /release/
    script: "./scripts/github-release.sh"
after_success:
- bash <(curl -s https://codecov.io/bash)
before_install:
- |
  if [[ "$TRAVIS_PULL_REQUEST" = "false" ]]; then
    openssl aes-256-cbc -K $encrypted_7f20b2c8d0fe_key -iv $encrypted_7f20b2c8d0fe_iv -in web3j.asc.enc -out web3j.asc -d
  fi
env:
  global:
  - secure: XXBFaK7tjSd39DCNVMiSqUqQeCLGZmqM7NPA5wWgagLKGlLDGKLZztQSCjypiqo4mQwJmClqqq1xXjZXdUkQ+7BUZimdly6NBbwOcX/hcK0wDmWcZogKyoUrKxhNI1TZIu5/PRvxJ8nUYH0kQZ/m50thLkBywA6MV8uGxmR6690LkzJUsCoG+swAo1m7diYg1IZX7tlXXZn8HP/srxvhtJA7UNj+bD9cVqyl8SYSRCqz0pmYO2d6JBH6kIr6pFJlNgYNnYlgO6efyOOw1+HH2Cj7M9gzxYcqEGapWZ8krqRNbwSQmfhzVYssyMJQ1me4JfDFweTCENptoTZL8JCqv+XPVEBXLhRbdAmwu6gG7k884N+HyzrW8iDxw8qxiWLaqM1KRt6YQRHBRqC7RcQdwIO0oEjM9RmYUQc6uRZMeo9PDL6wSL8bs/ysPP1XdR317OsrF6/0ZR0tI7nm8YkqSiOTsIG/A/D3d6X588hp59Qpb21vR/E8j6yNt24FkszIzPSubM5jFcWwCLTi64jpYIUewKyZSI+pYvT0GkwT7u3INhVmN4sFc1ff1LEeK5LJN5vJ+bscFHjxwh7V5PPBr+QWmfHb/LTV9j/qGqX1OKXsbXXd7P5zEqxm84rQ44Qi/wF3TlMYF0ySNi16zx9YpIFZwKSON45XaZaDyyXi+18=
  - secure: jSbXqAmVpELXHIXtg02Yr195/dZRvtYWnJPIFpcmG6BMCWqyT1LI5sRzAxH/JX8hLWYRUcxm7EV1yMDbOVYvIuREQu/DgVOfPrBh45fP4NiiUmWcwOChpohHfKDM4elyp6zHUC5Gl4TMQdYOX0Hvi9SHRExD9FHs+KjK1HX180tiaO1CCoolH6kaVl1WmN4LC8yxrc6OuLsTcIMw+HVbkalz4SmWQQFjYspS6GtS+Ne1mKxn78p6ba2ef9r51nB4LUPf8yo/RPndbQiCDTg0SankQMBDlyKXRj9HqrMouHG/+AHEUrby5xBKBONOcIcc+DqfbhvYBqCOkJapGsNVXQiTA10SRaIqprpuZcv97Dv6fRujZ5U1vR/sB07w6tX5i9Wvl/kA9CGEvDLV/ZfkBeFh9q3gjcL3MPyn9VDtIJw9txQqULfG+bjbmdjLjOaY71X0QzSyMwMZafb8L7a/jqBCdnRQJTHzC7O8I/AK19VhfN82Ahj198bd74kzP9TK5Z+ETmOZlGFSmV1yYvJTMRNdbxnNYQZEF5hLM7Y1it28ICV2PbzqW8SLYrXFBKUIzMkkxj+OnfvjRYaHV6Vb480omgsc5eLlZsDHjxoZkG/siRipCBkobjNbQsRi5IZZitdV5FtjY9imgYvP+8TH2v+WKT+5mIzgRG/82XOnPD4=
  - secure: GQqPH2/XgrZSb79ozR3HsCOqbSAeVLJulyH8kVtPro0WwFwpgkHF0Vl+uVEMTjZNYwwjdNLeDT6I1AUKfwfHsdXRf0aXfbV7HhvT36JJh7u95UMm1i7J3zek9j0pAfUJ4PufibH5miHANW7cOgYM66guLijHTXFV6ea+cM5iIAB67Njfx/0ca0EFpmNxOHK4SslT4V6avjW2yeizCTPoLnyU8iFAZM6B6D0eK5X/eURZtnTkacttP9hQTSjADqmNugMSJnKDvedVfO02HT/LbDhZbhOhXdfP8CwGDkRT+2HEc6IJfGIAsqon/xzSnZ1kkf1I9+1iUpJSlgQMlv8DzNiF+JT6XB9PIyp0S+ycDnCEIctTYMTrho2fFgAeaRQ0xePGrm2WTaECBzVs72g63UpCX5Fs/7z9mBvDePjoMojcAdYDcYmlNCUMp+3j50ipA0rIa1S/QctHAiQhahLK4wOEDuHuSNuZ3PXEoZIPeoZzjrMolSibuOo1Ga+3IbeGKoRDmXyVv0ohsrn0VS4LZNBdjKGpwHtqK7/xmD2W/2WHsfJAlSV21ntHgsFH96U/QkbOBGodpHfusQGLvMuxK8ZAhooAzst2VeeawhVpvPtuUJouN5WRfbi6JiupnXIbrzmyjJUZkEyJxhrMfGy2oBC+ncmK/ggAPvIo1ZUEJjw=
  - secure: bA/DG0Y0qS4gO/6q/1uC9xFUEP7B+SUgcZ68k3vHB34Y/yka4s/Sr6nalCUEr9Yrgd2VTwLRCp7y9Y+bGqQiOZeTUKflmBQ/josqDukKKWySglnRIR9zuNBAo67kOIsDL0EuVWHJ383VZVnKm2p5sGiun4h5VfLRGyDGZUQda6xKqfRTWO7QiHCN1aBDgEhyj93fs6pvkyM1QHbYOf746P8FzRnDH9mVGHqhPZV1DisLKUUPAWypwS4LbmBtzUy9mC5Gsz6TA75vnw3ZFZgmkc7CMbApTZAVcy8B3wOuCMS5eqJ5Jc6NvWtCUV55n6gevGEuFf38R7xuw4HNl/8bbOg8oB3ZbLznIh7S7pgefhzq4sRSWtUVcqar+bWPYjgmoCxe7pyGbAckcuYiqZATyIfwVY4N4Q5Ufq+of1SmLvViaCpG4LYFjMbFjIzKqBBROmiMKpYu851a8Zxn80hXKcEUb0V7GI/zzYID6mKkmQJ/TGS5DX0gFIulUXbPfKinazyPKw0MSot+bw5iX/IlM4LISExgFWxXbejMpb3NeJALmWv1/kAxMRX9SXObo5HPdStTTtY4Jfj6VSDdvKcNYIDqvZz8C0GtiiM7xfrJrNFB50trqE3vwh0vLph7B5dAEogT8O4YTUo2mIaX/slu76nq+aH309LgOXbpDQLCraI=
